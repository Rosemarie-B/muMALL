%======================================================%
% Explicit contexts
%======================================================%

%------------------------------------------------------%
% Length-indexed typing contexts
%------------------------------------------------------%

LF lctx : nat â†’ type =
| nil : lctx zero
| cons : lctx N â†’ tp â†’ mult â†’ lctx (suc N);

% Typing context equality

LF cx_eq : lctx N â†’ lctx N â†’ type =
| cx/refl : cx_eq Î” Î”;

%------------------------------------------------------%
% Main operations on typing contexts
%------------------------------------------------------%

% Splitting / merging typing contexts: Î”â‚ â‹ˆ Î”â‚‚ = Î”

LF merge : lctx N â†’ lctx N â†’ lctx N â†’ type =
| mg/n : merge nil nil nil
| mg/c : merge Î”â‚ Î”â‚‚ Î” â†’ â€¢ Î±â‚ Î±â‚‚ Î± â†’ merge (cons Î”â‚ A Î±â‚) (cons Î”â‚‚ A Î±â‚‚) (cons Î” A Î±);

% Î”[x :Î± A â†¦â‚™ y :Î² B] = Î”'
% i.e., x appears in Î” at position n with type A and multiplicity Î±, and
% Î”' is the result of changing that entry to y :Î² B

LF upd : lctx N â†’ tp â†’ mult â†’ mult â†’ lctx N â†’ type =
| upd/t : upd (cons Î” A Î±) A Î± Î±' (cons Î” A Î±')
| upd/n : upd Î” A Î± Î±' Î”' â†’ upd (cons Î” B Î²) A Î± Î±' (cons Î”' B Î²);

% Only unrestricted assumptions appear in Î”,
% parametric to the predicate "hal Î±"; in the case of linear type systems,
% "hal Î±" holds when Î± = ğŸ˜ (unavailable).

LF exh : lctx _ â†’ type =
| exh/n : exh nil
| exh/c : exh Î” â†’ hal Î± â†’ exh (cons Î” _ Î±);

% Î” â‰ˆ Î”', Î” = Î”' up to varying multiplicities
% (corresponds to 0Î” = 0Î”' for linear systems)

LF same_elts: lctx N â†’ lctx N â†’ type =
| se/n : same_elts nil nil
| se/c : same_elts Î” Î”' â†’ same_elts (cons Î” A _) (cons Î”' A _);
